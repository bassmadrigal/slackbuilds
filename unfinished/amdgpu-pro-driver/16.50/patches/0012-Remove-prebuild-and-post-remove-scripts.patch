From 4381745239942239462977388ebf0303deeea24d Mon Sep 17 00:00:00 2001
From: Jeremy Hansen <jebrhansen@gmail.com>
Date: Thu, 26 Jan 2017 13:19:32 -0500
Subject: [PATCH] Remove prebuild and post remove scripts

---
 usr/src/amdgpu-pro-16.50-362463/dkms.conf      |  2 --
 usr/src/amdgpu-pro-16.50-362463/post-remove.sh |  6 -----
 usr/src/amdgpu-pro-16.50-362463/pre-build.sh   | 37 --------------------------
 3 files changed, 45 deletions(-)
 delete mode 100755 usr/src/amdgpu-pro-16.50-362463/post-remove.sh
 delete mode 100755 usr/src/amdgpu-pro-16.50-362463/pre-build.sh

diff --git a/usr/src/amdgpu-pro-16.50-362463/dkms.conf b/usr/src/amdgpu-pro-16.50-362463/dkms.conf
index 7f11158..1bb38d8 100644
--- a/usr/src/amdgpu-pro-16.50-362463/dkms.conf
+++ b/usr/src/amdgpu-pro-16.50-362463/dkms.conf
@@ -4,7 +4,5 @@ BUILT_MODULE_NAME[0]="amdgpu"
 BUILT_MODULE_LOCATION[0]="amd/amdgpu"
 DEST_MODULE_LOCATION[0]="/updates"
 AUTOINSTALL="yes"
-PRE_BUILD="pre-build.sh $kernelver"
 
 REMAKE_INITRD="yes"
-POST_REMOVE="post-remove.sh $kernelver"
diff --git a/usr/src/amdgpu-pro-16.50-362463/post-remove.sh b/usr/src/amdgpu-pro-16.50-362463/post-remove.sh
deleted file mode 100755
index 54a1e9d..0000000
--- a/usr/src/amdgpu-pro-16.50-362463/post-remove.sh
+++ /dev/null
@@ -1,6 +0,0 @@
-#!/bin/bash
-
-FW_DIR="/lib/firmware/$1"
-rm -rf $FW_DIR/radeon
-rm -rf $FW_DIR/amdgpu
-[[ ! $(ls -A $FW_DIR) ]] && rm -rf $FW_DIR
diff --git a/usr/src/amdgpu-pro-16.50-362463/pre-build.sh b/usr/src/amdgpu-pro-16.50-362463/pre-build.sh
deleted file mode 100755
index 1f73723..0000000
--- a/usr/src/amdgpu-pro-16.50-362463/pre-build.sh
+++ /dev/null
@@ -1,37 +0,0 @@
-#!/bin/bash
-
-KERNELVER=$1
-KERNELVER_BASE=${KERNELVER%%-*}
-
-version_lt () {
-    newest=$((echo "$KERNELVER_BASE"; echo "$1") | sort -V | tail -n1)
-    [ "$KERNELVER_BASE" != "$newest" ]
-}
-
-version_ge () {
-    newest=$((echo "$KERNELVER_BASE"; echo "$1") | sort -V | tail -n1)
-    [ "$KERNELVER_BASE" = "$newest" ]
-}
-
-version_gt () {
-    oldest=$((echo "$KERNELVER_BASE"; echo "$1") | sort -V | head -n1)
-    [ "$KERNELVER_BASE" != "$oldest" ]
-}
-
-version_le () {
-    oldest=$((echo "$KERNELVER_BASE"; echo "$1") | sort -V | head -n1)
-    [ "$KERNELVER_BASE" = "$oldest" ]
-}
-
-source amd/backport/symbols
-
-echo '// auto generated by DKMS pre-build.sh' > amd/backport/symbols.c
-for sym in $SYMS; do
-    addr=$(grep "\<$sym\>" /boot/System.map-$KERNELVER | awk -F' ' '{print $1}')
-    echo "void *$sym = (void *)0x$addr;" >> amd/backport/symbols.c
-done
-
-FW_DIR="/lib/firmware/$KERNELVER"
-mkdir -p $FW_DIR
-cp -ar /usr/src/amdgpu-pro-16.50-362463/firmware/radeon $FW_DIR
-cp -ar /usr/src/amdgpu-pro-16.50-362463/firmware/amdgpu $FW_DIR
-- 
2.9.0

